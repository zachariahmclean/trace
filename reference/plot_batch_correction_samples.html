<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>plot size standard samples — plot_batch_correction_samples • trace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plot size standard samples — plot_batch_correction_samples"><meta name="description" content="Plot the overlapping traces of the size standards by their size standard ids"><meta property="og:description" content="Plot the overlapping traces of the size standards by their size standard ids"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>plot size standard samples</h1>

      <div class="d-none name"><code>plot_batch_correction_samples.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot the overlapping traces of the size standards by their size standard ids</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_batch_correction_samples</span><span class="op">(</span></span>
<span>  <span class="va">fragments_list</span>,</span>
<span>  sample_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_axis <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  n_facet_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fragments-list">fragments_list<a class="anchor" aria-label="anchor" href="#arg-fragments-list"></a></dt>
<dd><p>A list of fragments_repeats objects containing fragment data.</p></dd>


<dt id="arg-sample-subset">sample_subset<a class="anchor" aria-label="anchor" href="#arg-sample-subset"></a></dt>
<dd><p>A character vector of batch_sample_id for a subset of samples to plot. Or alternativly supply a numeric vector.</p></dd>


<dt id="arg-x-axis">x_axis<a class="anchor" aria-label="anchor" href="#arg-x-axis"></a></dt>
<dd><p>A character indicating what should be plotted on the x-axis, chose between <code>size</code> or <code>repeats</code>. Only use repeats if plotting after the repeat correction.</p></dd>


<dt id="arg-n-facet-col">n_facet_col<a class="anchor" aria-label="anchor" href="#arg-n-facet-col"></a></dt>
<dd><p>A numeric value indicating the number of columns for faceting in the plot.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>the x limits of the plot. A numeric vector of length two.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>plot traces from fragments object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A plot of the raw signal by bp size or repeats for the size standard samples. The cicle at the top of the plot is for the called allele for that sample.</p>
<p>When plotting the traces before repeat correction, we do not expect the samples to be closely overallping due to run-to-run variation. After repeat correction and plotting "repeats" on the x-axis, the traces should be bascially overlapping. It can be difficult from the "repeats" x-axis to figure out which sample is wrong because if one is wrong it will mess up the repeat size for all other samples in that same batch_run_id. Use the "size" x-axis to make sure all of the traces have the same distribution and modal peak."</p>
<p>These plots are made using base R plotting. Sometimes these fail to render in the viewing panes of IDEs (eg you get the error 'Error in <code><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new()</a></code>: figure margins too large)'. If this happens, try saving the plot as a pdf using traditional approaches (see grDevices::pdf). To get it to render in the IDE pane, trying matching <code>n_facet_col</code> to the number of samples you're attmpting to plot, or using <code>sample_subset</code> to limit it to a single sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_ladders</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_ladders.html">find_ladders</a></span><span class="op">(</span><span class="va">cell_line_fsa_list</span>, show_progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># duplicate data to generate an example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_metadata.html">add_metadata</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  fragments_list <span class="op">=</span> <span class="va">test_ladders</span>,</span></span>
<span class="r-in"><span>  metadata_data.frame <span class="op">=</span> <span class="va">metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_metadata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">test_metadata</span>, <span class="kw">function</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sample2</span> <span class="op">&lt;-</span> <span class="va">sample</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sample2</span><span class="op">$</span><span class="va">trace_bp_df</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">sample2</span><span class="op">$</span><span class="va">trace_bp_df</span><span class="op">$</span><span class="va">size</span> <span class="op">+</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">sample2</span><span class="op">$</span><span class="va">unique_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">unique_id</span>, <span class="st">"_2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sample2</span><span class="op">$</span><span class="va">batch_run_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sample2</span><span class="op">$</span><span class="va">batch_run_id</span>, <span class="st">"_2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sample2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test_metadata2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">test_metadata2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">unique_id</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metadata_added_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">test_metadata</span>, <span class="va">test_metadata2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_fragments</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_fragments.html">find_fragments</a></span><span class="op">(</span><span class="va">metadata_added_combined</span>, min_bp_size <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_alleles</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_alleles.html">find_alleles</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  fragments_list <span class="op">=</span> <span class="va">test_fragments</span>,</span></span>
<span class="r-in"><span>  number_of_peaks_to_return <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  peak_region_size_gap_threshold <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  peak_region_height_threshold_multiplier <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_repeats_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="call_repeats.html">call_repeats</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  fragments_list <span class="op">=</span> <span class="va">test_alleles</span>,</span></span>
<span class="r-in"><span>  repeat_calling_algorithm <span class="op">=</span> <span class="st">"simple"</span>,</span></span>
<span class="r-in"><span>  assay_size_without_repeat <span class="op">=</span> <span class="fl">87</span>,</span></span>
<span class="r-in"><span>  repeat_size <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  batch_correction <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_A04.fsa: repeats were not called (no main peaks in sample)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_B07.fsa: repeats were not called (no main peaks in sample)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_D11.fsa: repeats were not called (no main peaks in sample)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_A04.fsa_2: repeats were not called (no main peaks in sample)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_B07.fsa_2: repeats were not called (no main peaks in sample)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>20230413_D11.fsa_2: repeats were not called (no main peaks in sample)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># traces of bp size shows traces at different sizes</span></span></span>
<span class="r-in"><span><span class="fu">plot_batch_correction_samples</span><span class="op">(</span><span class="va">test_repeats_corrected</span>,</span></span>
<span class="r-in"><span>  x_axis <span class="op">=</span> <span class="st">"size"</span>,</span></span>
<span class="r-in"><span>  sample_subset <span class="op">=</span> <span class="st">"S-21-212"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">450</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_batch_correction_samples-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overlapping traces when looking at the corrected repeat length</span></span></span>
<span class="r-in"><span><span class="fu">plot_batch_correction_samples</span><span class="op">(</span><span class="va">test_repeats_corrected</span>,</span></span>
<span class="r-in"><span>  x_axis <span class="op">=</span> <span class="st">"repeats"</span>,</span></span>
<span class="r-in"><span>  sample_subset <span class="op">=</span> <span class="st">"S-21-212"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">130</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_batch_correction_samples-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachariah McLean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

