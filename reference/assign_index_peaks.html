<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assign index peaks — assign_index_peaks • trace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assign index peaks — assign_index_peaks"><meta name="description" content="Assign index peaks in preparation for calculation of instability metrics"><meta property="og:description" content="Assign index peaks in preparation for calculation of instability metrics"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plotting_traces.html">Plotting traces</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Assign index peaks</h1>

      <div class="d-none name"><code>assign_index_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Assign index peaks in preparation for calculation of instability metrics</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assign_index_peaks</span><span class="op">(</span></span>
<span>  <span class="va">fragments_list</span>,</span>
<span>  grouped <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  index_override_dataframe <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fragments-list">fragments_list<a class="anchor" aria-label="anchor" href="#arg-fragments-list"></a></dt>
<dd><p>A list of "fragments_repeats" class objects representing
fragment data.</p></dd>


<dt id="arg-grouped">grouped<a class="anchor" aria-label="anchor" href="#arg-grouped"></a></dt>
<dd><p>Logical value indicating whether samples should be grouped to
share a common index peak. <code>FALSE</code> will assign the sample's own modal allele as the index peak. <code>TRUE</code> will use metadata to assign the index peak based on the modal peak of another sample (see below for more details).</p></dd>


<dt id="arg-index-override-dataframe">index_override_dataframe<a class="anchor" aria-label="anchor" href="#arg-index-override-dataframe"></a></dt>
<dd><p>A data.frame to manually set index peaks.
Column 1: unique sample IDs, Column 2: desired index peaks (the order of the
columns is important since the information is pulled by column position rather
than column name). Closest peak in each sample is selected so the number needs to just be approximate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function modifies list of fragments_repeats objects in place with index_repeat and index_signal added.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A key part of instability metrics is the index peak. This is the repeat
length used as the reference peak for relative instability metrics calculations, like expansion index.
This is usually the the inherited repeat length of a mouse, or the modal repeat length for the cell line at a starting time point.</p>
<p>If <code>grouped</code> is set to <code>TRUE</code>, this function groups the samples by their <code>metrics_group_id</code> and uses the samples set as <code>metrics_baseline_control</code> to set the index peak. Use <code><a href="add_metadata.html">add_metadata()</a></code> to set these variables. This is useful for cases like inferring repeat size of inherited alleles from mouse tail data. If the samples that are going to be used to assign index peak are from different fragment analysis runs, use <code>correction = "batch"</code> in <code><a href="call_repeats.html">call_repeats()</a></code> to make sure the systematic differences between runs are corrected and the correct index peak is assigned. If there are multiple samples used as baseline control, the median value will be used to assign index peak to corresponding samples.</p>
<p>For mice, if just a few samples have the inherited repeat signal shorter than the expanded population, you could not worry about this and instead use the <code>index_override_dataframe</code>. This can be used to manually override these assigned index repeat values (irrespective of whether <code>grouped</code> is TRUE or FALSE).</p>
<p>As a final option, the index peak could be manually assigned directly to a <a href="fragments_repeats.html">fragments_repeats</a> class using the internal setter function fragments_repeats$set_index_peak().</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsa_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">cell_line_fsa_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="find_ladders.html">find_ladders</a></span><span class="op">(</span><span class="va">fsa_list</span>, show_progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fragments_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_fragments.html">find_fragments</a></span><span class="op">(</span><span class="va">fsa_list</span>,</span></span>
<span class="r-in"><span>  min_bp_size <span class="op">=</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="find_alleles.html">find_alleles</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fragments_list</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="call_repeats.html">call_repeats</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fragments_list</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="add_metadata.html">add_metadata</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fragments_list</span>,</span></span>
<span class="r-in"><span>  metadata_data.frame <span class="op">=</span> <span class="fu">trace</span><span class="fu">::</span><span class="va"><a href="metadata.html">metadata</a></span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">assign_index_peaks</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fragments_list</span>,</span></span>
<span class="r-in"><span>  grouped <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_traces.html">plot_traces</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">150</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="assign_index_peaks-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachariah McLean, Kevin Correia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

