<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find Alleles in Fragments List — find_alleles • trace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find Alleles in Fragments List — find_alleles"><meta name="description" content="This function identifies main alleles within each fragment in a list of fragments."><meta property="og:description" content="This function identifies main alleles within each fragment in a list of fragments."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find Alleles in Fragments List</h1>

      <div class="d-none name"><code>find_alleles.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function identifies main alleles within each fragment in a list of fragments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_alleles</span><span class="op">(</span></span>
<span>  <span class="va">fragments_list</span>,</span>
<span>  number_of_peaks_to_return <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  peak_region_size_gap_threshold <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  peak_region_height_threshold_multiplier <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fragments-list">fragments_list<a class="anchor" aria-label="anchor" href="#arg-fragments-list"></a></dt>
<dd><p>A list of fragment objects containing peak data.</p></dd>


<dt id="arg-number-of-peaks-to-return">number_of_peaks_to_return<a class="anchor" aria-label="anchor" href="#arg-number-of-peaks-to-return"></a></dt>
<dd><p>Number of main peaks to be returned for each fragment. Must either be 1 or 2 if a normal sized allele is also to be found.</p></dd>


<dt id="arg-peak-region-size-gap-threshold">peak_region_size_gap_threshold<a class="anchor" aria-label="anchor" href="#arg-peak-region-size-gap-threshold"></a></dt>
<dd><p>Gap threshold for identifying peak regions. The peak_region_size_gap_threshold is a parameter used to determine the maximum allowed gap between peak sizes within a peak region. Adjusting this parameter affects the size range of peaks that can be grouped together in a region. A smaller value makes it more stringent, while a larger value groups peaks with greater size differences, leading to broader peak regions that may encompass wider size ranges.</p></dd>


<dt id="arg-peak-region-height-threshold-multiplier">peak_region_height_threshold_multiplier<a class="anchor" aria-label="anchor" href="#arg-peak-region-height-threshold-multiplier"></a></dt>
<dd><p>Multiplier for the peak height threshold. The peak_region_height_threshold_multiplier parameter allows adjusting the threshold for identifying peak regions based on peak heights. Increasing this multiplier value will result in higher thresholds, making it more stringent to consider peaks as part of a peak region. Conversely, reducing the multiplier value will make the criteria less strict, potentially leading to more peaks being grouped into peak regions. It's important to note that this parameter's optimal value depends on the characteristics of the data and the specific analysis goals. Choosing an appropriate value for this parameter can help in accurately identifying meaningful peak regions in the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of fragments with identified main alleles.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function finds the main alleles for each fragment in the list by identifying clusters of peaks ("peak regions")
with the highest signal intensities. This is based on the idea that PCR amplicons of repeats have broad peaks and PCR artififacts that help identifying the alleles.
The number of peaks to be returned, and the parameters for identifying peak regions can be customized.
It's important to note that both peak_region_height_threshold_multiplier and peak_region_size_gap_threshold influence the criteria for identifying peak regions, and finding the right balance between them is crucial.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">file_list</span> <span class="op">&lt;-</span> <span class="fu">trace</span><span class="fu">::</span><span class="va"><a href="cell_line_fsa_list.html">cell_line_fsa_list</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_ladders</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_ladders.html">find_ladders</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fragments_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_fragments.html">find_fragments</a></span><span class="op">(</span><span class="va">test_ladders</span>,</span></span>
<span class="r-in"><span>  min_bp_size <span class="op">=</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_alleles</span> <span class="op">&lt;-</span> <span class="fu">find_alleles</span><span class="op">(</span></span></span>
<span class="r-in"><span>  fragments_list <span class="op">=</span> <span class="va">fragments_list</span>,</span></span>
<span class="r-in"><span>  number_of_peaks_to_return <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  peak_region_size_gap_threshold <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  peak_region_height_threshold_multiplier <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachariah McLean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

