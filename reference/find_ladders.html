<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ladder and bp sizing — find_ladders • trace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ladder and bp sizing — find_ladders"><meta name="description" content="Find the ladder peaks in and use that to call bp size"><meta property="og:description" content="Find the ladder peaks in and use that to call bp size"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plotting_traces.html">Plotting traces</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ladder and bp sizing</h1>

      <div class="d-none name"><code>find_ladders.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find the ladder peaks in and use that to call bp size</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_ladders</span><span class="op">(</span></span>
<span>  <span class="va">fragments_trace</span>,</span>
<span>  ladder_channel <span class="op">=</span> <span class="st">"DATA.105"</span>,</span>
<span>  signal_channel <span class="op">=</span> <span class="st">"DATA.1"</span>,</span>
<span>  ladder_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">139</span>, <span class="fl">150</span>, <span class="fl">160</span>, <span class="fl">200</span>, <span class="fl">250</span>, <span class="fl">300</span>, <span class="fl">340</span>, <span class="fl">350</span>, <span class="fl">400</span>, <span class="fl">450</span>, <span class="fl">490</span>,</span>
<span>    <span class="fl">500</span><span class="op">)</span>,</span>
<span>  ladder_start_scan <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minimum_peak_signal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scan_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ladder_selection_window <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_combinations <span class="op">=</span> <span class="fl">2500000</span>,</span>
<span>  warning_rsq_threshold <span class="op">=</span> <span class="fl">0.998</span>,</span>
<span>  show_progress_bar <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fragments-trace">fragments_trace<a class="anchor" aria-label="anchor" href="#arg-fragments-trace"></a></dt>
<dd><p>list from 'read_fsa' function</p></dd>


<dt id="arg-ladder-channel">ladder_channel<a class="anchor" aria-label="anchor" href="#arg-ladder-channel"></a></dt>
<dd><p>string: which channel in the fsa file contains the
ladder signal</p></dd>


<dt id="arg-signal-channel">signal_channel<a class="anchor" aria-label="anchor" href="#arg-signal-channel"></a></dt>
<dd><p>string: which channel in the fsa file contains the data
signal</p></dd>


<dt id="arg-ladder-sizes">ladder_sizes<a class="anchor" aria-label="anchor" href="#arg-ladder-sizes"></a></dt>
<dd><p>numeric vector: bp sizes of ladder used in fragment analysis.
defaults to GeneScan™ 500 LIZ™</p></dd>


<dt id="arg-ladder-start-scan">ladder_start_scan<a class="anchor" aria-label="anchor" href="#arg-ladder-start-scan"></a></dt>
<dd><p>numeric: indicate the scan number to start looking for
ladder peaks. Usually this can be automatically found (when set to NULL) since
there's a big spike right at the start. However, if your ladder peaks
are taller than the big spike, you will need to set this starting scan
number manually.</p></dd>


<dt id="arg-minimum-peak-signal">minimum_peak_signal<a class="anchor" aria-label="anchor" href="#arg-minimum-peak-signal"></a></dt>
<dd><p>numeric: minimum signal of peak from smoothed signal.</p></dd>


<dt id="arg-scan-subset">scan_subset<a class="anchor" aria-label="anchor" href="#arg-scan-subset"></a></dt>
<dd><p>numeric vector (length 2): filter the ladder and data signal
between the selected scans (eg scan_subset = c(3000, 5000)).
to pracma::savgol().</p></dd>


<dt id="arg-ladder-selection-window">ladder_selection_window<a class="anchor" aria-label="anchor" href="#arg-ladder-selection-window"></a></dt>
<dd><p>numeric: in the ladder assigning algorithm,
the we iterate through the scans in blocks and test their linear fit ( We can assume that the ladder is linear over a short distance)
This value defines how large that block of peaks should be.</p></dd>


<dt id="arg-max-combinations">max_combinations<a class="anchor" aria-label="anchor" href="#arg-max-combinations"></a></dt>
<dd><p>numeric: what is the maximum number of ladder
combinations that should be tested</p></dd>


<dt id="arg-warning-rsq-threshold">warning_rsq_threshold<a class="anchor" aria-label="anchor" href="#arg-warning-rsq-threshold"></a></dt>
<dd><p>The value for which this function will warn you when parts of the ladder have R-squared values below the specified threshold.</p></dd>


<dt id="arg-show-progress-bar">show_progress_bar<a class="anchor" aria-label="anchor" href="#arg-show-progress-bar"></a></dt>
<dd><p>show progress bar</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function modifies list of fragments_trace objects in place with the ladder assigned and base pair calculated.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function takes a list of fragments_trace files (the output from read_fsa) and identifies
the ladders in the ladder channel which is used to call the bp size. The output
is a list of fragments_traces.</p>
<p>In this package, base pair (bp) sizes are assigned using a generalized additive model (GAM) with cubic regression splines. The model is fit to known ladder fragment sizes and their corresponding scan positions, capturing the relationship between scan number and bp size. Once trained, the model predicts bp sizes for all scans by interpolating between the known ladder points. This approach provides a flexible and accurate assignment of bp sizes, accommodating the slightly non-linear relationship.</p>
<p>Use <code><a href="plot_data_channels.html">plot_data_channels()</a></code> to plot the raw data on the fsa file to identify which channel the ladder and data are in.</p>
<p>The ladder peaks are assigned from largest to smallest. I would recommend excluding
size standard peaks less than 50 bp (eg size standard 35 bp).</p>
<p>Each ladder should be manually inspected to make sure that is has been correctly assigned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_data_channels.html">plot_data_channels()</a></code> to plot the raw data in all channels. <code><a href="plot_ladders.html">plot_ladders()</a></code> to plot the assigned ladder
peaks onto the raw ladder signal. <code><a href="fix_ladders_interactive.html">fix_ladders_interactive()</a></code> to fix ladders with
incorrectly assigned peaks.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fsa_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">cell_line_fsa_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">find_ladders</span><span class="op">(</span><span class="va">fsa_list</span>, show_progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Manually inspect the ladders</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_ladders.html">plot_ladders</a></span><span class="op">(</span><span class="va">fsa_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="find_ladders-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachariah McLean, Kevin Correia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

