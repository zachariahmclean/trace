<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting traces • trace</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting traces">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/plotting_traces.html">Plotting traces</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plotting traces</h1>
            
      

      <div class="d-none name"><code>plotting_traces.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zachariahmclean.github.io/trace/">trace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>lets first generate some example data by cloning the example data
that comes with the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fsa_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">cell_line_fsa_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_ladders.html">find_ladders</a></span><span class="op">(</span></span>
<span>  <span class="va">fsa_list</span>,</span>
<span>  show_progress_bar <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fragments_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_fragments.html">find_fragments</a></span><span class="op">(</span></span>
<span>  <span class="va">fsa_list</span>,</span>
<span>  min_bp_size <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/add_metadata.html">add_metadata</a></span><span class="op">(</span></span>
<span>  fragments_list <span class="op">=</span> <span class="va">fragments_list</span>,</span>
<span>  metadata_data.frame <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>  unique_id <span class="op">=</span> <span class="st">"unique_id"</span>,</span>
<span>  metrics_group_id <span class="op">=</span> <span class="st">"metrics_group_id"</span>,</span>
<span>  metrics_baseline_control <span class="op">=</span> <span class="st">"metrics_baseline_control"</span>,</span>
<span>  batch_run_id <span class="op">=</span> <span class="st">"batch_run_id"</span>,</span>
<span>  batch_sample_id <span class="op">=</span> <span class="st">"batch_sample_id"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_alleles.html">find_alleles</a></span><span class="op">(</span></span>
<span>  fragments_list <span class="op">=</span> <span class="va">fragments_list</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/call_repeats.html">call_repeats</a></span><span class="op">(</span></span>
<span>  fragments_list <span class="op">=</span> <span class="va">fragments_list</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-a-trace">plotting a trace<a class="anchor" aria-label="anchor" href="#plotting-a-trace"></a>
</h2>
<p>There are functions built into this package for plotting traces</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_traces.html">plot_traces</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>, show_peaks <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting_traces_files/figure-html/unnamed-chunk-2-1.png" width="691.2"></p>
<p>This is convenient for quickly visualizing traces, but since it’s
built using base r plotting, it’s not very user friendly and difficult
to customize. We can be easily replicate this in ggplot2 for more
flexibility and customization.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_trace_table.html">extract_trace_table</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">calculated_repeats</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">calculated_repeats</span>, <span class="va">signal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="plotting_traces_files/figure-html/unnamed-chunk-3-1.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="extract-raw-traces">Extract raw traces<a class="anchor" aria-label="anchor" href="#extract-raw-traces"></a>
</h2>
<p>The raw traces can be extracted from the objects at any point after a
call to <code><a href="../reference/find_ladders.html">find_ladders()</a></code>. However, if we extract the traces
after <code><a href="../reference/call_repeats.html">call_repeats()</a></code>, the repeats will be called on the
trace data too. This also incorporates any batch correction (if used
<code>call_repeats(batch_correction = TRUE)</code>) that would allow
comparison of traces across different fragment analysis runs. Without a
batch correction, the traces may not be comparable across fragment
analysis runs and be off-alignment by several +- ~3 bp.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">traces_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_trace_table.html">extract_trace_table</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">)</span></span></code></pre></div>
<p>This is quite a large dataframe (550k rows) since it contains each
scan (5961 per sample) from all samples in the example dataset. If you
know exactly what samples you want to plot, you could first subset
repeats_list before passing to extract_trace_table. It’s just a regular
list, named with the unique id for each sample. So it can be subsetted
with the unique id names. As an example, lets pull out a couple of
unique ids from our metadata:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">samples_for_plotting</span> <span class="op">&lt;-</span> <span class="va">metadata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">metrics_group_id</span> <span class="op">==</span> <span class="st">"CC6"</span><span class="op">)</span>, <span class="st">"unique_id"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">traces_for_plotting_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_trace_table.html">extract_trace_table</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">[</span><span class="va">samples_for_plotting</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This is a long dataframe, meaning that the trace table for each
sample was bound by rows. They are uniquely identified with the
unique_id column in the dataframe.</p>
<p>This dataframe has the following columns:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="66%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>unique_id</td>
<td>Unique sample id.</td>
</tr>
<tr class="even">
<td>scan</td>
<td>The individual scan number when the data was collected during
capillary electrophoresis.</td>
</tr>
<tr class="odd">
<td>size</td>
<td>Base pair size at each individual scan.</td>
</tr>
<tr class="even">
<td>signal</td>
<td>The raw signal from the channel with the data of interest.</td>
</tr>
<tr class="odd">
<td>ladder_signal</td>
<td>The raw ladder signal from the ladder channel.</td>
</tr>
<tr class="even">
<td>off_scale</td>
<td>Indicating if the instrument called the data off scale for this
scan. Note this could be from any channel.</td>
</tr>
<tr class="odd">
<td>calculated_repeats</td>
<td>The repeat size calculated from within call_repeats() function.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="join-metadata">Join metadata<a class="anchor" aria-label="anchor" href="#join-metadata"></a>
</h2>
<p>We can join metadata to this table for downstream plotting</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  <span class="va">traces_for_plotting_df</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">unique_id</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-the-traces">Plot the traces<a class="anchor" aria-label="anchor" href="#plot-the-traces"></a>
</h2>
<p>We can now plot the traces in whatever way we like. For this I’ll
show an example using ggplot2. To explain some of the choices here:</p>
<ul>
<li>I’ll use <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>to zoom in on the area of
interest</li>
<li>geom_line needs <code>aes(group = unique_id)</code> to make sure
each sample’s traces is plotted separately</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">calculated_repeats</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calculated_repeats</span>,</span>
<span>             y <span class="op">=</span> <span class="va">signal</span>,</span>
<span>             colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">unique_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Day"</span>, <span class="va">day</span>, <span class="va">treatment</span>, <span class="st">"nM Branaplam"</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting_traces_files/figure-html/unnamed-chunk-7-1.png" width="691.2"></p>
<p>This plot is plotting the traces from within the same group on top of
each other. This shows us that our replicate samples were very
reproducible and are basically on top of each other.</p>
<p>One issue is that the height of the signal for each sample varies. We
can solve that by calculating a relative signal value. This means we
also need to filter out the sample that had a failed PCR (low signal).
To help with this, lets also extract the allele information and pull out
the id of the sample to exclude.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">alleles_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_alleles.html">extract_alleles</a></span><span class="op">(</span><span class="va">fragments_list</span><span class="op">[</span><span class="va">samples_for_plotting</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_to_exclude</span> <span class="op">&lt;-</span> <span class="va">alleles_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">alleles_df</span><span class="op">$</span><span class="va">allele_repeat</span><span class="op">)</span><span class="op">)</span>, <span class="st">"unique_id"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">&lt;-</span> <span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">calculated_repeats</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>                <span class="op">!</span><span class="va">unique_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_to_exclude</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">unique_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>relative_signal <span class="op">=</span> <span class="va">signal</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">signal</span><span class="op">)</span>,</span>
<span>         day_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Day"</span>, <span class="va">day</span>, <span class="va">treatment</span>, <span class="st">"nM Branaplam"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calculated_repeats</span>,</span>
<span>             <span class="va">relative_signal</span>,</span>
<span>             colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">unique_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">day_treatment</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting_traces_files/figure-html/unnamed-chunk-8-1.png" width="691.2"></p>
<p>We can also use some tricks to overlay the traces on top of a
reference trace. Some key things with this plot:</p>
<ul>
<li><p>We are selecting a single sample for each treatment (group_by +
filter)</p></li>
<li><p>to make one sample common across all facets, we can use
geom_line(data = _ ) with a dataset that has the faceting column
removed.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">d0_trace</span> <span class="op">&lt;-</span> <span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">day</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unique_id</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">unique_id</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">day_treatment</span><span class="op">)</span></span>
<span></span>
<span><span class="va">traces_for_plotting_with_metadata_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unique_id</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">unique_id</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calculated_repeats</span>,</span>
<span>             y <span class="op">=</span> <span class="va">relative_signal</span>,</span>
<span>             colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Day"</span>, <span class="va">day</span>, <span class="va">treatment</span>, <span class="st">"nM Branaplam"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d0_trace</span> ,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">unique_id</span><span class="op">)</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">unique_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">day_treatment</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting_traces_files/figure-html/unnamed-chunk-9-1.png" width="691.2"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachariah McLean, Kevin Correia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
